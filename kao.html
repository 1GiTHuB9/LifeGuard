<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaomoji Calendar</title>
    <link rel="stylesheet" href="./css/kao.css">
</head>
<body>
<div class="fullscreen-image">
    <img src="haikei4.png" alt="Full Screen Image">

    <!-- カレンダーのコンテナ -->
    <div class="calendar-container">
        <!-- 左矢印（前月へ） -->
        <button id="prev-month" class="month-nav-btn">◀</button>

        <!-- 月名を表示 -->
        <div class="month-header" id="month-header"></div>

        <!-- カレンダー -->
        <div class="calendar" id="calendar"></div>

        <!-- 右矢印（次月へ） -->
        <button id="next-month" class="month-nav-btn">▶</button>
    </div>

    <!-- 顔文字選択モーダル -->
    <div class="overlay" id="overlay"></div>
    <div id="kaomoji-modal" class="kaomoji-selector">
        <p>顔文字を選択してください:</p>
        <div id="kaomoji-list">
            <img src="./img/nicokan.png" alt="Kaomoji 1" data-kaomoji="nicokan.png" class="kaomoji-option">
            <img src="./img/nakikan.png" alt="Kaomoji 2" data-kaomoji="nakikan.png" class="kaomoji-option">
            <img src="./img/okokan.png" alt="Kaomoji 3" data-kaomoji="okokan.png" class="kaomoji-option">
        </div>
        <br><br>
        <!--<button id="select-btn">選択</button>-->
        <button id="cancel-btn">キャンセル</button>
    </div>
</div>
<script>
const monthHeader = document.getElementById('month-header');
const calendar = document.getElementById('calendar');
const prevMonthBtn = document.getElementById('prev-month');
const nextMonthBtn = document.getElementById('next-month');

let currentDate = new Date();
renderCalendar(currentDate);

// 前月ボタンのクリックイベント
prevMonthBtn.onclick = () => {
    currentDate.setMonth(currentDate.getMonth() - 1); // 月を減少
    slideCalendar(-1); // 左にスライド
};

// 次月ボタンのクリックイベント
nextMonthBtn.onclick = () => {
    currentDate.setMonth(currentDate.getMonth() + 1); // 月を増加
    slideCalendar(1); // 右にスライド
};

// カレンダーを描画する関数
function renderCalendar(date) {
    const year = date.getFullYear();
    const month = date.getMonth();
    const daysInMonth = new Date(year, month + 1, 0).getDate(); // 月の日数を取得
    const firstDayOfMonth = new Date(year, month, 1).getDay(); // 月の初日の曜日

    const monthNames = ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"];
    const dayNames = ["日", "月", "火", "水", "木", "金", "土"];

    // 月と年のヘッダーを表示
    monthHeader.textContent = `${year}年 ${monthNames[month]}`;

    // カレンダーのクリア
    calendar.innerHTML = '';

    // 曜日ヘッダーを追加
    dayNames.forEach(day => {
        const headerElement = document.createElement('div');
        headerElement.className = 'header';
        headerElement.textContent = day;
        calendar.appendChild(headerElement);
    });

    // 空のセルを最初に追加して、月初日の曜日位置を調整
    for (let i = 0; i < firstDayOfMonth; i++) {
        const emptyCell = document.createElement('div');
        calendar.appendChild(emptyCell);
    }

    // カレンダーの日付を生成
    for (let day = 1; day <= daysInMonth; day++) {
        const dayElement = document.createElement('div');
        dayElement.className = 'day';
        dayElement.innerHTML = `<strong>${day}</strong> <div class="kaomoji" id="kaomoji-${day}"></div>`;
        dayElement.onclick = () => showKaomojiSelector(dayElement);
        calendar.appendChild(dayElement);
    }
}

// カレンダーをスライドするアニメーション関数
function slideCalendar(direction) {
    const initialPosition = direction === 1 ? 'slide-right' : 'slide-left';
    calendar.classList.add(initialPosition);

    setTimeout(() => {
        renderCalendar(currentDate);
        calendar.classList.remove(initialPosition);
    }, 500); // アニメーションの時間と同期させる
}

// モーダルに関連するコード
const kaomojiModal = document.getElementById('kaomoji-modal');
const overlay = document.getElementById('overlay');
const kaomojiOptions = document.querySelectorAll('.kaomoji-option');
const cancelBtn = document.getElementById('cancel-btn');

let selectedDayElement = null;

function showKaomojiSelector(dayElement) {
    selectedDayElement = dayElement; // 選択された日付要素を保存
    overlay.style.display = 'block';
    kaomojiModal.style.display = 'block';
    kaomojiList.innerHTML = ''; // 選択をリセット

    // 顔文字画像を再度追加する
    const kaomojiImages = [
        "kaomoji1.png",
        "kaomoji2.png",
        "kaomoji3.png"
    ];
}

function closeKaomojiSelector() {
    overlay.style.display = 'none';
    kaomojiModal.style.display = 'none';
}

// 顔文字をクリックで日付に表示
kaomojiOptions.forEach(option => {
    option.onclick = () => {
        const selectedKaomoji = option.getAttribute('data-kaomoji');
        if (selectedKaomoji && selectedDayElement) {
            const kaomojiDiv = selectedDayElement.querySelector('.kaomoji');
            kaomojiDiv.innerHTML = `<img src="./img/${selectedKaomoji}" alt="Kaomoji">`;
            closeKaomojiSelector();
        }
    };
});

cancelBtn.onclick = closeKaomojiSelector;
overlay.onclick = closeKaomojiSelector;
</script>

</body>
</html>
